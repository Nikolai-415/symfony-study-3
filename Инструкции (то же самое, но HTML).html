<!doctype html>
<html lang="ru">
    <head>
        <title>Инструкции</title>
    </head>
    <body style="font-size: 20px">
        <h2>Используемые технологии</h2>

        <ol>
          <li><i><b>Docker-Compose v.3.9</b></i>;</li>
          <li><i><b>PHP v.8.1.9</b></i>;</li>
          <li><i><b>Symfony v.5.3.6</b></i>;</li>
          <li><i><b>Xdebug v.3.1.5</b></i>;</li>
          <li><i><b>Composer v.2.3.10</b></i>;</li>
          <li><i><b>Nginx v.1.23.1</b></i>;</li>
          <li><i><b>PostgreSQL v.14.4</b></i>;</li>
          <li><i><b>pgAdmin4 v.6.12</b></i>;</li>
          <li><i><b>Bootstrap v.5.0.2</b></i>.</li>
        </ol>

        <h2>Необходимые компоненты</h2>

        <ul>
          <li>Docker (используется Docker-Compose).</li>
        </ul>

        <h2>Установка</h2>

        <ol>
          <li>Запустить терминал в корне проекта;</li>
          <li>Добавить shell-команды командой:<br/>
          <code>. commands-prod.sh</code>
          </li>
          <li>Собрать проект командой:<br/>
          <code>n415 build project</code>
          </li>
        </ol>

        <h2>Запуск</h2>

        <ol>
          <li>Запустить проект командой:<br/>
          <code>n415 up</code>
          </li>
          <li>Создать таблицы в БД командой (только при первом запуске):<br/>
          <code>n415 tables create</code>
          </li>
          <li>Заполнить таблицы в БД командой (только при первом запуске):<br/>
          <code>n415 tables seed</code>
          </li>
          <li>Система будет доступна по адресу:<br/>
          <a href="http://localhost:80/" target="_blank">http://localhost:80/</a><br/>
          PGadmin (запускается спустя некоторое время после запуска PHP):<br/>
          <a href="http://localhost:8080/" target="_blank">http://localhost:8080/</a><br/>
          </li>
        </ol>

        <h2>Немного о структуре</h2>

        <ul>
          <li>В корне проекта расположен сам проект Symfony со всеми файлами. Dockerfile для PHP и Docker-Compose.yml также расположены тут.</li>
          <li>В папке "nginx" расположен файл конфигурации для Nginx.</li>
          <li>В папке "postgres" расположен Dockerfile для PostgreSQL, а также SQL-скрипты (в папке "sql").</li>
          <li>Конфигурационные ini-файлы для PHP я расположил в папке "./config/ini".</li>
        </ul>

        <h2>Краткое описание</h2>

        <ol>
          <li>На главной странице ничего примечательного не отображается. Неавторизованным пользователям доступны страницы для авторизации и регистрации.</li>
          <li>
            В БД по умолчанию присутствуют записи двух пользователей:<br/>
            <ul>
              <li><b>admin</b> (имеет все роли);</li>
              <li><b>user</b> (не имеет ролей).</li>
            </ul>
            Пароль от обоих учётных записей: <b>password</b>.
          </li>
          <li>
            После регистрации идёт перенаправление на форму авторизации (я ещё не разобрался как сделать автоматический вход после неё).
          </li>
          <li>
            После авторизации пользователь попадает снова на главную страницу. В меню теперь доступны страница просмотра записей (при наличии соответствующей роли) и страница выхода из аккаунта.
          </li>
          <li>
            На странице просмотра записей, помимо самой таблицы, присутствует кнопка для добавления записи, а также кнопки для фильтрации и сортировки. Присутствует панель паджинации сверху и снизу таблицы.
          </li>
          <li>
            Для каждой записи в таблице есть также кнопки для изменения и удаления. Они доступны только если пользователь имеет соответствующие роли.
          </li>
          <li>
            Все поля в таблице отображаются стандартно, за исключением аватара, который отображается как картинка, и файла, для которого отображается кнопка для скачивания.
          </li>
        </ol>

        <h2>PGadmin</h2>

        <ol>
          <li>Авторизация в PGadmin:<br/>
            <ul>
              <li>Username: <b>admin@mail.com</b>;</li>
              <li>Password: <b>password</b>.</li>
            </ul>
          </li>
          <li>При работе в PGadmin, добавить сервер необходимо с настройками:<br/>
            <ul>
              <li>Host: <b>postgres</b>;</li>
              <li>Port: <b>5432</b>;</li>
              <li>Username: <b>admin</b>;</li>
              <li>Password: <b>password</b>.</li>
            </ul>
          </li>
        </ol>

        <h2>Остановка</h2>

        <ul>
          <li>Остановить проект командой:<br/>
          <code>n415 down</code>
          </li>
        </ul>

        <h2>Смена окружения</h2>

        <ul>
          <li>По умолчанию используется окружение Production. Для смены на Development используется команда (необходимо остановить контейнеры):<br/>
          <code>n415 set stopped dev</code>
          </li>
          <li>Для смены на Production используется аналогичная команда:<br/>
          <code>n415 set stopped prod</code>
          </li>
        </ul>

        <h2>Удаление</h2>
        <ol>
          <li>Очистить проект командой:<br/>
          <code>n415 clear project</code>
          </li>
          <li>Конфигурация проекта использует образы: <i><b>nginx:1.23.1</b></i> и <i><b>dpage/pgadmin4:6.12</b></i>. Если они больше нигде не используются, то и их удалить соответствующими командами:<br/>
          <code>docker rmi nginx:1.23.1</code><br/>
          <code>docker rmi dpage/pgadmin4:6.12</code></li>
        </ol>
    </body>
</html>